---
title: "manuscript"
format: 
  html:
    code-fold: true
editor: visual
---

```{r, echo=FALSE}
#| include = FALSE
library(tidyverse)
```

```{r, echo=FALSE, cache=TRUE}
#| include = FALSE
tissue <- read_delim("data/salmon.merged.gene_tpm.tsv", col_names = TRUE)
```

## Introduction

The geoduck genome has 34,947 genes.

```{r schemat, echo = FALSE, out.width = "70%", fig.align = "center"}

knitr::include_graphics("img/genome.png")
```

```{r}
#| include = FALSE
gtab <- read_delim("data/20220419-pgen-gene-accessions-gene_id-gene_name-gene_description-alt_gene_description-go_ids.tab", col_names = FALSE)
```

```{r}
#| include = FALSE
head(gtab)
```

## Expression

```{r}
#| include = FALSE
top <- read_delim("data/geoduck_topmarkers_annot.txt", col_names = TRUE)
```

## Methods

## Results

Of the 34,947 genes, `r count(tissue %>% filter(ctenidia == 0, gonad == 0, heart == 0, juvenile == 0, larvae == 0))` were not expressed in any tissues. `r count(tissue %>% filter(ctenidia > 0, gonad > 0, heart > 0, juvenile > 0, larvae > 0))` genes were detected in all five tissues types. Table

```{r}
#| include = FALSE


count(tissue %>% filter(ctenidia > 0, gonad == 0, heart == 0, juvenile == 0, larvae == 0))

count(tissue %>% filter(ctenidia == 0, gonad > 0, heart == 0, juvenile == 0, larvae == 0))

count(tissue %>% filter(ctenidia == 0, gonad == 0, heart > 0, juvenile == 0, larvae == 0))

count(tissue %>% filter(ctenidia == 0, gonad == 0, heart == 0, juvenile > 0, larvae == 0))

count(tissue %>% filter(ctenidia == 0, gonad == 0, heart == 0, juvenile == 0, larvae > 0))
```

| Sample   | Unique Genes | Col3 |
|----------|--------------|------|
| ctenidia | 340          |      |
| gonad    | 119          |      |
| heart    | 371          |      |
| juvenile | 2180         |      |
| larvae   | 868          |      |

```{r}
#| include = FALSE
sc_num <- read_delim("data/rowData_df_genes_by_numcells_expressed", col_names = TRUE)
```

In addition to looking at expression profiles in tissue and whole organims (juvenile and larvae) single-cell sequencing was carried out developing embryo. In total `r count(sc_num %>% filter(num_cells_expressed > 0))` genes were expressed. Expressed varied as per Figure

```{r}
#| warning = FALSE
ggplot(sc_num, aes(x=num_cells_expressed)) + geom_histogram(bins = 100) +
scale_y_continuous(trans='log2')
```
